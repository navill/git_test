modified from branch - iss53
